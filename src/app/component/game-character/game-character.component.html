<!--移動値mの文字列4つ-->
<div *ngIf="this.gameCharacter.showPing">
    <div class="is-3d is-pointer-events-none lazy-move circle-text" [ngStyle]="
      {'transform': 'translateX(' + gameCharacter.concentricLocation.x + 'px) translateY(' + gameCharacter.concentricLocation.y + 'px)',
      'font-size': (normalSpeed*10) / currentTableScale + 'px'
      }">
        <div *ngIf="!this.gameCharacter.hideInformation" class="is-pointer-events-none" [ngStyle]="{
            'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px) ' +
            'translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
            'height': (normalSpeed * gridSize / currentTableScale)*2 + 'px',
            'width': (normalSpeed * gridSize / currentTableScale)*2 + 'px'}">
            <span [ngStyle]="{'height': (normalSpeed * gridSize / currentTableScale) + 'px'}">{{normalSpeed}}m</span>
            <span [ngStyle]="{'height': (normalSpeed * gridSize / currentTableScale) + 'px'}">{{normalSpeed}}m</span>
            <span [ngStyle]="{'height': (normalSpeed * gridSize / currentTableScale) + 'px'}">{{normalSpeed}}m</span>
            <span [ngStyle]="{'height': (normalSpeed * gridSize / currentTableScale) + 'px'}">{{normalSpeed}}m</span>
        </div>
    </div>
</div>
<!--同心円エフェクト-->
<div class="is-3d is-pointer-events-none lazy-move" [ngStyle]="
  {'transform': 'translateX(' + gameCharacter.concentricLocation.x + 'px) translateY(' + gameCharacter.concentricLocation.y + 'px)' }">
    <div *ngIf="this.gameCharacter.showPing" class="is-pointer-events-none" [ngStyle]="{'width': '0px', 'height': '0px'}">
        <div *ngIf="!this.gameCharacter.hideInformation && currentTableScale<3" class="ping-gradient is-pointer-events-none" [ngStyle]="{
      'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px)'
                  + ' translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
      'border-radius': (normalSpeed * gridSize / currentTableScale) +'px',
      'height': (normalSpeed * gridSize / currentTableScale)*2 + 'px',
      'width': (normalSpeed * gridSize / currentTableScale)*2 + 'px',
      'background-image': 'repeating-radial-gradient(' + 
        'circle at 50% 50%,' + 
        'transparent 0px,' + 
        'transparent ' + (gridSize / currentTableScale-6) + 'px,' + 
        'currentcolor ' + (gridSize / currentTableScale-4) + 'px,' + 
        'currentcolor ' + (gridSize / currentTableScale) + 'px' + 
      ')'
    }"></div>
        <div *ngIf="!this.gameCharacter.hideInventory" class="ping-circle is-pointer-events-none" [ngStyle]="{
      'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px)'
                  + ' translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
      'border-radius': (3 * gridSize / currentTableScale) +'px',
      'height': (3 * gridSize / currentTableScale)*2 + 'px',
      'width': (3 * gridSize / currentTableScale)*2 + 'px',
      'border': 'dashed ' + (6 / currentTableScale) + 'px skyblue'
    }"></div>
        <div *ngIf="!this.gameCharacter.hideInventory" class="ping-circle is-pointer-events-none" [ngStyle]="{
      'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px)'
                  + ' translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
      'border-radius': (10 * gridSize / currentTableScale) +'px',
      'height': (10 * gridSize / currentTableScale)*2 + 'px',
      'width': (10 * gridSize / currentTableScale)*2 + 'px',
      'border': 'dashed ' + (10 / currentTableScale) + 'px red'
    }"></div>
        <div *ngIf="!this.gameCharacter.hideInventory" class="ping-circle is-pointer-events-none" [ngStyle]="{
      'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px)'
                  + ' translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
      'border-radius': (20 * gridSize / currentTableScale) +'px',
      'height': (20 * gridSize / currentTableScale)*2 + 'px',
      'width': (20 * gridSize / currentTableScale)*2 + 'px',
      'border': 'dashed ' + (10 / currentTableScale) + 'px red'
    }"></div>
        <div *ngIf="!this.gameCharacter.hideInventory" class="ping-circle is-pointer-events-none" [ngStyle]="{
      'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px)'
                  + ' translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
      'border-radius': (30 * gridSize / currentTableScale) +'px',
      'height': (30 * gridSize / currentTableScale)*2 + 'px',
      'width': (30 * gridSize / currentTableScale)*2 + 'px',
      'border': 'dashed ' + (10 / currentTableScale) + 'px red'
    }"></div>
        <div *ngIf="!this.gameCharacter.hideInventory" class="ping-circle is-pointer-events-none" [ngStyle]="{
      'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px)'
                  + ' translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
      'border-radius': (40 * gridSize / currentTableScale) +'px',
      'height': (40 * gridSize / currentTableScale)*2 + 'px',
      'width': (40 * gridSize / currentTableScale)*2 + 'px',
      'border': 'dashed ' + (10 / currentTableScale) + 'px red'
    }"></div>
        <div *ngIf="!this.gameCharacter.hideInventory" class="ping-circle is-pointer-events-none" [ngStyle]="{
      'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px)'
                  + ' translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
      'border-radius': (50 * gridSize / currentTableScale) +'px',
      'height': (50 * gridSize / currentTableScale)*2 + 'px',
      'width': (50 * gridSize / currentTableScale)*2 + 'px',
      'border': 'dashed ' + (10 / currentTableScale) + 'px red'
    }"></div>
        <div *ngIf="!this.gameCharacter.hideInformation" class="ping-circle is-pointer-events-none" [ngStyle]="{
      'transform': ' translateX(-50%) translateX(' + (size * gridSize / 2) +'px)'
                  + ' translateY(-50%) translateY(' + (size * gridSize / 2) +'px)',
      'border-radius': (normalSpeed * gridSize / currentTableScale) +'px',
      'height': (normalSpeed * gridSize / currentTableScale)*2 + 'px',
      'width': (normalSpeed * gridSize / currentTableScale)*2 + 'px',
      'border': 'dashed ' + (10 / currentTableScale) + 'px black'
    }"></div>
    </div>
</div>
<div class="component is-3d is-grab is-pointer-events-none" [style.width.px]="size * gridSize" [style.height.px]="size * gridSize" appMovable [movable.option]="movableOption" (movable.ondragstart)="onMove()" (movable.ondragend)="onMoved()" #root>
    <div class="component-content is-3d" [@bounceInOut]="'in'">
        <div class="component-content is-3d is-pointer-events-auto" appRotable [rotable.option]="rotableOption" (rotable.ondragstart)="onMove()" (rotable.ondragend)="onMoved()" (auxclick)="onAuxClick($event)" (dblclick)="onDoubleClick($event)">
            <!--足元の丸枠フチ色-->
            <div *ngIf="this.gameCharacter.hideInformation" class="pedestal-inner" [ngStyle]="{
              'border': 'solid 10px #ff69b4',
              'border-radius': size * gridSize / 2 +'px'
              }"></div>
            <div *ngIf="!this.gameCharacter.hideInventory" class="pedestal-inner" [ngStyle]="{
              'border': 'solid 6px #FFCC80',
              'border-radius': size * gridSize / 2 +'px'
              }"></div>
            <div *ngIf="this.gameCharacter.hideInventory" class="pedestal-inner" [ngStyle]="{
              'border': 'solid 6px #A0E0FF',
              'border-radius': size * gridSize / 2 +'px'
              }"></div>
            <div class="pedestal-outer" [ngStyle]="{
              'border-radius': size * gridSize / 2 +'px'
              }"></div>
            <div class="pedestal-grab rotate-grab" [ngStyle]="{
              'border-radius': size * gridSize / 2 +'px'
              }">
                <!--床回転アイコン-->
                <div class="pedestal-grab-border" [ngStyle]="{
                  'border-radius': size * gridSize / 2 +'px'
                  }">
                    <div class="material-icons of-front">autorenew</div>
                    <div class="material-icons of-back">autorenew</div>
                </div>
            </div>
            <div class="upright-transform is-fit-width is-3d">
                <!---->
                <div class="rotate-frame is-3d" [style.width.px]="size * gridSize" [style.height.px]="size * gridSize" appRotable [(rotable.value)]="roll" (rotable.ondragstart)="onMove()" (rotable.ondragend)="onMoved()">
                    <div class="rotate-inner is-3d">
                        <!--バフ表示-->
                        <div *ngIf="this.gameCharacter.buffDataElement">
                            <ng-container *ngIf="this.gameCharacter.buffDataElement.children.length == 1">
                                <ng-container *ngFor="let child of this.gameCharacter.buffDataElement.children">
                                    <ng-container *ngIf="child.children.length > 0">

                                        <div *ngIf="this.gameCharacter.buffDataElement" class="buff-tag is-nowrap is-buff-background is-3d" [ngStyle]="{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px) translateY(-100%)'}">

                                            <div class="table fornt-tag">
                                                <div class="flex-item" *ngFor="let childElement of this.gameCharacter.buffDataElement.children">
                                                    <div class="table-row" game-data-element-buff [gameDataElement]="childElement" [isEdit]="isEdit" [isPieceMode]="true"></div>
                                                </div>
                                            </div>
                                            <div class="table back-tag">
                                                <div class="flex-item" *ngFor="let childElement of this.gameCharacter.buffDataElement.children">
                                                    <div class="table-row" game-data-element-buff [gameDataElement]="childElement" [isEdit]="isEdit" [isPieceMode]="true"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>
                                </ng-container>
                            </ng-container>
                        </div>
                        <!--名前表示-->
                        <ng-container *ngIf="this.gameCharacter.nonTalkFlag">
                            <div *ngIf="0 < name.length" class="name-tag is-nowrap is-black-background is-3d" [ngStyle]="{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px)'
                              ,'background-color': 'rgba(255,255,255, 0.6)' , 'color' : '#333' ,  'border': 'solid 1px #555' }">
                                <div class="fornt-tag has-length-limit is-3d">{{name}}</div>
                                <div class="back-tag has-length-limit is-3d">{{name}}</div>
                            </div>
                        </ng-container>
                        <ng-container *ngIf="!this.gameCharacter.nonTalkFlag">
                            <div *ngIf="0 < name.length" class="name-tag is-nowrap is-black-background is-3d" [ngStyle]="{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}">
                                <div class="fornt-tag has-length-limit is-3d">{{name}}</div>
                                <div class="back-tag has-length-limit is-3d">{{name}}</div>
                            </div>
                        </ng-container>
                        <img class="image" *ngIf="0 < imageFile.url.length" [src]="imageFile.url | safe: 'resourceUrl'">
                        <!--HPMPバー表示-->
                        <ng-container *ngIf="!this.gameCharacter.hideInformation">
                            <!-- HP -->
                            <div *ngIf="hashp" class="is-nowrap is-3d" [ngStyle]="{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px)'
                               ,'background-color': 'rgba(255,255,255, 0.6)' , 'color' : '#333' ,  'border': 'solid 1px #555' }">
                                <div class="barline" [ngStyle]="
                                  {'width': maxhp * size * gridSize / maxhp + 'px'
                                  ,'background-color': 'rgba(255,0,0,0.6)'
                                  ,'transform': 'translateY(-15px)' }"></div>
                                <div class="barline" [ngStyle]="
                                  {'width': currenthp * size * gridSize / maxhp + 'px'
                                  ,'background-color': '#4f0'
                                  ,'transform': 'translateY(-15px)' }"></div>
                            </div>
                            <!-- MP -->
                            <div *ngIf="hasmp" [ngStyle]="{'transform': 'translateX(1px)'}">
                                <div class="barline" [ngStyle]="
                                  {'width': maxmp * size * gridSize / maxmp + 'px'
                                  ,'height': 5 + 'px'
                                  ,'background-color': 'rgba(200,200,200,0.6)'
                                  ,'transform': 'translateY(-7px)' }"></div>
                                <div class="barline" [ngStyle]="
                                  {'width': currentmp * size * gridSize / maxmp + 'px'
                                  ,'height': 5 + 'px'
                                  ,'background-color': '#00f'
                                  ,'transform': 'translateY(-7px)' }"></div>
                            </div>
                            <div *ngIf="hashp">
                                <!-- stripe -->
                                <div class="barstripe" [ngStyle]="
                                  {'width': maxhp * size * gridSize / maxhp + 'px'
                                  ,'height': 6 + 'px'
                                  ,'background-image': 'repeating-linear-gradient(90deg, rgba(255,255,255, 0.2) 0%, rgba(64,64,64, 0.5) ' + tenperhp + '%)'
                                  ,'transform': 'translateX(5px) translateY(-14.5px)' }"></div>
                            </div>
                        </ng-container>
                        <!--回転部キャラ上-->
                        <div class="grab-group">
                            <div class="rotate-grab rotate-grab-icon of-top" [ngStyle]="{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px)'}">
                                <i class="material-icons">autorenew</i>
                            </div>
                            <div class="rotate-grab rotate-grab-icon of-bottom" [ngStyle]="{'transform': 'translateX(-50%) translateX(' + size * gridSize / 2 +'px'}">
                                <i class="material-icons">autorenew</i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>